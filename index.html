<!DOCTYPE html>
<html lang="pt-BR">
<head>
Â  <link rel="icon" href="data:;base64,iVBORw0KGgo=">
Â  <title>A BÃºssola da Alta Performance - Empresarial</title>
Â  <style>
Â  Â  body {
Â  Â  Â  background-color: #000;
Â  Â  Â  color: #fff;
Â  Â  Â  font-family: sans-serif;
Â  Â  Â  padding: 20px;
Â  Â  Â  max-width: 800px;
Â  Â  Â  margin: 0 auto;
Â  Â  }
Â  Â  input, button {
Â  Â  Â  padding: 10px;
Â  Â  Â  font-size: 1em;
Â  Â  Â  margin-top: 10px;
Â  Â  }
Â  Â  button {
Â  Â  Â  background-color: #007bff;
Â  Â  Â  color: #fff;
Â  Â  Â  border: none;
Â  Â  Â  cursor: pointer;
Â  Â  Â  border-radius: 4px;
Â  Â  Â  transition: background-color 0.3s;
Â  Â  }
Â  Â  button:hover {
Â  Â  Â  background-color: #0056b3;
Â  Â  }
Â  Â  button:disabled {
Â  Â  Â  background-color: #6c757d;
Â  Â  Â  cursor: not-allowed;
Â  Â  }
Â  Â  .hidden { display: none; }
Â  Â  label {
Â  Â  Â  display: block;
Â  Â  Â  margin: 8px 0;
Â  Â  Â  cursor: pointer;
Â  Â  }
Â  Â  input[type="radio"] {
Â  Â  Â  margin-right: 8px;
Â  Â  }
Â  Â  input[type="text"], input[type="email"] {
Â  Â  Â  width: 100%;
Â  Â  Â  max-width: 400px;
Â  Â  Â  border: 1px solid #333;
Â  Â  Â  background-color: #222;
Â  Â  Â  color: #fff;
Â  Â  Â  border-radius: 4px;
Â  Â  }
Â  Â  .progress-bar {
Â  Â  Â  height: 10px;
Â  Â  Â  background-color: #333;
Â  Â  Â  border-radius: 5px;
Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  overflow: hidden;
Â  Â  }
Â  Â  .progress {
Â  Â  Â  height: 100%;
Â  Â  Â  background-color: #007bff;
Â  Â  Â  width: 0%;
Â  Â  Â  transition: width 0.3s ease;
Â  Â  }
Â  Â  .resultado-container {
Â  Â  Â  margin-top: 20px;
Â  Â  }
Â  Â  .perfil-item { /* Mantido para possÃ­vel uso, mas serÃ¡ mais genÃ©rico agora */
Â  Â  Â  margin: 5px 0;
Â  Â  Â  font-size: 1.1em;
Â  Â  }
Â  Â  .perfil-predominante { /* Este estilo serÃ¡ adaptado ou removido, pois nÃ£o hÃ¡ um Ãºnico predominante */
Â  Â  Â  color: #007bff;
Â  Â  Â  font-weight: bold;
Â  Â  Â  font-size: 1.2em;
Â  Â  }
Â  Â  #debug-info {
Â  Â  Â  margin-top: 20px;
Â  Â  Â  padding: 10px;
Â  Â  Â  background-color: #333;
Â  Â  Â  border-radius: 4px;
Â  Â  Â  font-family: monospace;
Â  Â  Â  font-size: 12px;
Â  Â  Â  white-space: pre-wrap;
Â  Â  Â  display: none;
Â  Â  }
Â  Â  .email-status {
Â  Â  Â  margin-top: 15px;
Â  Â  Â  padding: 10px;
Â  Â  Â  border-radius: 4px;
Â  Â  Â  text-align: center;
Â  Â  }
Â  Â  .success {
Â  Â  Â  background-color: rgba(40, 167, 69, 0.2);
Â  Â  Â  border: 1px solid #28a745;
Â  Â  }
Â  Â  .error {
Â  Â  Â  background-color: rgba(220, 53, 69, 0.2);
Â  Â  Â  border: 1px solid #dc3545;
Â  Â  }
Â  Â  .warning {
Â  Â  Â  background-color: rgba(255, 193, 7, 0.2);
Â  Â  Â  border: 1px solid #ffc107;
Â  Â  Â  color: #212529;
Â  Â  }
Â  Â  .perfil-detalhado { /* SerÃ¡ adaptado para descriÃ§Ãµes das dimensÃµes */
Â  Â  Â  margin-top: 30px;
Â  Â  Â  background-color: rgba(255, 255, 255, 0.1);
Â  Â  Â  border-radius: 8px;
Â  Â  Â  padding: 20px;
Â  Â  }
Â  Â  .perfil-detalhado h3 {
Â  Â  Â  color: #007bff;
Â  Â  Â  margin-top: 0;
Â  Â  Â  border-bottom: 1px solid rgba(255, 255, 255, 0.2);
Â  Â  Â  padding-bottom: 10px;
Â  Â  }
Â  Â  .perfil-secao {
Â  Â  Â  margin-bottom: 20px;
Â  Â  }
Â  Â  .perfil-secao h4 {
Â  Â  Â  color: #f8f9fa;
Â  Â  Â  margin-bottom: 8px;
Â  Â  Â  font-size: 1.1em;
Â  Â  }
Â  Â  .perfil-secao p {
Â  Â  Â  margin: 5px 0;
Â  Â  Â  line-height: 1.5;
Â  Â  }
Â  Â  .loading {
Â  Â  Â  text-align: center;
Â  Â  Â  padding: 20px;
Â  Â  }
Â  Â  .loading::after {
Â  Â  Â  content: '';
Â  Â  Â  display: inline-block;
Â  Â  Â  width: 20px;
Â  Â  Â  height: 20px;
Â  Â  Â  border: 3px solid #007bff;
Â  Â  Â  border-radius: 50%;
Â  Â  Â  border-top-color: transparent;
Â  Â  Â  animation: spin 1s ease-in-out infinite;
Â  Â  Â  margin-left: 10px;
Â  Â  }
Â  Â  @keyframes spin {
Â  Â  Â  to { transform: rotate(360deg); }
Â  Â  }
Â  Â  .validation-error {
Â  Â  Â  color: #dc3545;
Â  Â  Â  font-size: 0.9em;
Â  Â  Â  margin-top: 5px;
Â  Â  }
Â  </style>
</head>
<body>
Â  <h2>A BÃºssola da Alta Performance - Empresarial ðŸ§ </h2>
Â Â 
Â  <div id="intro-container">
Â  Â  <label for="name">Digite seu nome completo para comeÃ§ar:</label><br>
Â  Â  <input type="text" id="name" placeholder="Seu nome aqui" autocomplete="name" required /><br>
Â  Â  <div id="name-error" class="validation-error hidden">Por favor, insira seu nome completo.</div>
Â  Â Â 
Â  Â  <label for="email">Digite seu e-mail:</label><br>
Â  Â  <input type="email" id="email" placeholder="Seu e-mail aqui" autocomplete="email" required /><br>
Â  Â  <div id="email-error" class="validation-error hidden">Por favor, insira um e-mail vÃ¡lido.</div>
Â  Â Â 
Â  Â  <button id="start-button">ComeÃ§ar</button>
Â  </div>

Â  <div id="quiz" class="hidden">
Â  Â  <div class="progress-bar">
Â  Â  Â  <div id="progress" class="progress"></div>
Â  Â  </div>
Â  Â  <div id="question-container"></div>
Â  </div>

Â  <div id="resultado-container" class="hidden resultado-container">
Â  Â  <h3 id="perfil-titulo"></h3>
Â  Â  <div id="perfil-detalhes"></div>
Â  Â  <div id="grafico-container">
Â  Â  Â  <canvas id="graficoPerfil" width="300" height="300"></canvas>
Â  Â  </div>
Â  Â Â 
Â  Â  <div id="perfil-detalhado" class="perfil-detalhado"></div>
Â  Â Â 
Â  Â  <div id="email-status" class="email-status hidden"></div>
Â  Â Â 
Â  Â  <div class="container" style="margin-top: 20px;">
Â  Â  Â  <button id="restart-button">Refazer Teste</button>
Â  Â  </div>
Â  Â  <div id="debug-info"></div>
Â  </div>
Â Â 
Â  <script>
Â  Â  // ConfiguraÃ§Ãµes e constantes
Â  Â  const CONFIG = {
Â  Â  Â  WEBHOOK_URL: "https://primary-kh0f-zuper.up.railway.app/webhook/bussola_empresarial",
Â  Â  Â  MAX_RETRIES: 3,
Â  Â  Â  RETRY_DELAY: 2000,
Â  Â  Â  EMAIL_SEND_DELAY: 1000
Â  Â  };

Â  Â  // Array completo com as 16 categorias/perguntas e suas opÃ§Ãµes (sem embaralhamento)
Â  Â  const categoriasBase = [
Â  Â  Â  {
Â  Â  Â  Â  categoria: "LIDERANÃ‡A",
Â  Â  Â  Â  opcoes: [
Â  Â  Â  Â  Â  { texto: "Funcional", valor: 4 },
Â  Â  Â  Â  Â  { texto: "Organizacional", valor: 3 },
Â  Â  Â  Â  Â  { texto: "LÃ­deres", valor: 2 },
Â  Â  Â  Â  Â  { texto: "Comandar", valor: 1 }
Â  Â  Â  Â  ]
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  categoria: "ESTRUTURA",
Â  Â  Â  Â  opcoes: [
Â  Â  Â  Â  Â  { texto: "Organograma", valor: 4 },
Â  Â  Â  Â  Â  { texto: "Personograma", valor: 3 },
Â  Â  Â  Â  Â  { texto: "Tribograma", valor: 2 },
Â  Â  Â  Â  Â  { texto: "Eugrama", valor: 1 }
Â  Â  Â  Â  ]
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  categoria: "PESSOAS",
Â  Â  Â  Â  opcoes: [
Â  Â  Â  Â  Â  { texto: "Times", valor: 4 },
Â  Â  Â  Â  Â  { texto: "Colaboradores", valor: 3 },
Â  Â  Â  Â  Â  { texto: "Ajudantes", valor: 2 },
Â  Â  Â  Â  Â  { texto: "VoluntÃ¡rios", valor: 1 }
Â  Â  Â  Â  ]
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  categoria: "PROCESSOS",
Â  Â  Â  Â  opcoes: [
Â  Â  Â  Â  Â  { texto: "Fluxos & GovernanÃ§a", valor: 4 },
Â  Â  Â  Â  Â  { texto: "Fluxos BÃ¡sicos", valor: 3 },
Â  Â  Â  Â  Â  { texto: "Caminho", valor: 2 },
Â  Â  Â  Â  Â  { texto: "DecisÃµes", valor: 1 }
Â  Â  Â  Â  ]
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  categoria: "CULTURA",
Â  Â  Â  Â  opcoes: [
Â  Â  Â  Â  Â  { texto: "PropÃ³sito", valor: 4 },
Â  Â  Â  Â  Â  { texto: "Valores", valor: 3 },
Â  Â  Â  Â  Â  { texto: "Comportamento", valor: 2 },
Â  Â  Â  Â  Â  { texto: "Ambiente", valor: 1 }
Â  Â  Â  Â  ]
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  categoria: "AMBIENTE",
Â  Â  Â  Â  opcoes: [
Â  Â  Â  Â  Â  { texto: "Dominante", valor: 4 },
Â  Â  Â  Â  Â  { texto: "Competitivo", valor: 3 },
Â  Â  Â  Â  Â  { texto: "FlexÃ­vel", valor: 2 },
Â  Â  Â  Â  Â  { texto: "Estimulante", valor: 1 }
Â  Â  Â  Â  ]
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  categoria: "FOCO",
Â  Â  Â  Â  opcoes: [
Â  Â  Â  Â  Â  { texto: "Time", valor: 4 },
Â  Â  Â  Â  Â  { texto: "Empresa", valor: 3 },
Â  Â  Â  Â  Â  { texto: "Produto", valor: 2 },
Â  Â  Â  Â  Â  { texto: "Cliente", valor: 1 }
Â  Â  Â  Â  ]
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  categoria: "ESTRATÃ‰GIA",
Â  Â  Â  Â  opcoes: [
Â  Â  Â  Â  Â  { texto: "Implementar", valor: 4 },
Â  Â  Â  Â  Â  { texto: "Realizar", valor: 3 },
Â  Â  Â  Â  Â  { texto: "Planejar", valor: 2 },
Â  Â  Â  Â  Â  { texto: "Executar", valor: 1 }
Â  Â  Â  Â  ]
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  categoria: "EXPERIÃŠNCIA",
Â  Â  Â  Â  opcoes: [
Â  Â  Â  Â  Â  { texto: "ExcelÃªncia", valor: 4 },
Â  Â  Â  Â  Â  { texto: "SatisfaÃ§Ã£o", valor: 3 },
Â  Â  Â  Â  Â  { texto: "Engajamento", valor: 2 },
Â  Â  Â  Â  Â  { texto: "InovaÃ§Ã£o", valor: 1 }
Â  Â  Â  Â  ]
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  categoria: "SAÃšDE",
Â  Â  Â  Â  opcoes: [
Â  Â  Â  Â  Â  { texto: "Financeiro", valor: 4 },
Â  Â  Â  Â  Â  { texto: "FÃ­sico", valor: 3 },
Â  Â  Â  Â  Â  { texto: "Mental", valor: 2 },
Â  Â  Â  Â  Â  { texto: "Emocional", valor: 1 }
Â  Â  Â  Â  ]
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  categoria: "FERRAMENTAS",
Â  Â  Â  Â  opcoes: [
Â  Â  Â  Â  Â  { texto: "Especializadas", valor: 4 },
Â  Â  Â  Â  Â  { texto: "BÃ¡sicas", valor: 3 },
Â  Â  Â  Â  Â  { texto: "Digitais", valor: 2 },
Â  Â  Â  Â  Â  { texto: "Manuais", valor: 1 }
Â  Â  Â  Â  ]
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  categoria: "DADOS",
Â  Â  Â  Â  opcoes: [
Â  Â  Â  Â  Â  { texto: "Positivos", valor: 4 },
Â  Â  Â  Â  Â  { texto: "Negativos", valor: 3 },
Â  Â  Â  Â  Â  { texto: "Qualitativos", valor: 2 },
Â  Â  Â  Â  Â  { texto: "Quantitativos", valor: 1 }
Â  Â  Â  Â  ]
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  categoria: "RESULTADO",
Â  Â  Â  Â  opcoes: [
Â  Â  Â  Â  Â  { texto: "Objetivos", valor: 4 },
Â  Â  Â  Â  Â  { texto: "Metas", valor: 3 },
Â  Â  Â  Â  Â  { texto: "Lucro", valor: 2 },
Â  Â  Â  Â  Â  { texto: "Impacto", valor: 1 }
Â  Â  Â  Â  ]
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  categoria: "OBJETIVO",
Â  Â  Â  Â  opcoes: [
Â  Â  Â  Â  Â  { texto: "Profissionalizar", valor: 4 },
Â  Â  Â  Â  Â  { texto: "Otimizar", valor: 3 },
Â  Â  Â  Â  Â  { texto: "Diversificar", valor: 2 },
Â  Â  Â  Â  Â  { texto: "Expandir", valor: 1 }
Â  Â  Â  Â  ]
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  categoria: "PAPEL DO DONO",
Â  Â  Â  Â  opcoes: [
Â  Â  Â  Â  Â  { texto: "Empreender Tudo", valor: 4 },
Â  Â  Â  Â  Â  { texto: "Gerenciar Tudo", valor: 3 },
Â  Â  Â  Â  Â  { texto: "Fazer Tudo", valor: 2 },
Â  Â  Â  Â  Â  { texto: "Decidir Tudo", valor: 1 }
Â  Â  Â  Â  ]
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  categoria: "VERBO",
Â  Â  Â  Â  opcoes: [
Â  Â  Â  Â  Â  { texto: "Dirigir", valor: 4 },
Â  Â  Â  Â  Â  { texto: "Coordenar", valor: 3 },
Â  Â  Â  Â  Â  { texto: "Fazer", valor: 2 },
Â  Â  Â  Â  Â  { texto: "Conduzir", valor: 1 }
Â  Â  Â  Â  ]
Â  Â  Â  }
Â  Â  ];
Â  Â Â 
Â  Â  // VariÃ¡veis globais
Â  Â  let perguntas = []; // Agora sÃ£o as categorias
Â  Â  let respostas = {}; // Armazena a opÃ§Ã£o escolhida por categoria
Â  Â  let pontuacoesCategorias = {}; // Armazena a pontuaÃ§Ã£o total por categoria
Â  Â  let userName = "";
Â  Â  let userEmail = "";
Â  Â  let perguntaAtual = 0;
Â  Â  let debugMode = false;
Â  Â  let resultadoAtual = null; // ArmazenarÃ¡ os resultados processados
Â  Â  let graficoChart = null;
Â  Â  let emailEnviado = false;
Â  Â  let tentativasEnvio = 0;

Â  Â  // InformaÃ§Ãµes detalhadas sobre cada categoria (opcional, para futura expansÃ£o)
Â  Â  // No momento, nÃ£o hÃ¡ descriÃ§Ãµes detalhadas fornecidas para cada uma das 16 categorias.
Â  Â  // Esta seÃ§Ã£o pode ser expandida no futuro se houver necessidade de explicar o que significa cada pontuaÃ§Ã£o.
Â  Â  const categoriasDetalhe = {
Â  Â  Â  'LIDERANÃ‡A': {
Â  Â  Â  Â  descricao: 'Avalia o estilo e a eficÃ¡cia da lideranÃ§a na organizaÃ§Ã£o.'
Â  Â  Â  },
Â  Â  Â  'ESTRUTURA': {
Â  Â  Â  Â  descricao: 'Mede a clareza e adequaÃ§Ã£o da estrutura organizacional.'
Â  Â  Â  },
Â  Â  Â  'PESSOAS': {
Â  Â  Â  Â  descricao: 'Foca na gestÃ£o de talentos e no ambiente humano da empresa.'
Â  Â  Â  },
Â  Â  Â  'PROCESSOS': {
Â  Â  Â  Â  descricao: 'Avalia a eficiÃªncia e a padronizaÃ§Ã£o dos processos internos.'
Â  Â  Â  },
Â  Â  Â  'CULTURA': {
Â  Â  Â  Â  descricao: 'Reflete os valores, crenÃ§as e comportamentos predominantes.'
Â  Â  Â  },
Â  Â  Â  'AMBIENTE': {
Â  Â  Â  Â  descricao: 'Analisa o clima e as condiÃ§Ãµes de trabalho.'
Â  Â  Â  },
Â  Â  Â  'FOCO': {
Â  Â  Â  Â  descricao: 'Determina para onde a atenÃ§Ã£o e os recursos da empresa estÃ£o direcionados.'
Â  Â  Â  },
Â  Â  Â  'ESTRATÃ‰GIA': {
Â  Â  Â  Â  descricao: 'Avalia a clareza e a execuÃ§Ã£o dos planos de longo prazo.'
Â  Â  Â  },
Â  Â  Â  'EXPERIÃŠNCIA': {
Â  Â  Â  Â  descricao: 'Mede a qualidade das interaÃ§Ãµes e a satisfaÃ§Ã£o geral.'
Â  Â  Â  },
Â  Â  Â  'SAÃšDE': {
Â  Â  Â  Â  descricao: 'Examina o bem-estar financeiro, fÃ­sico e mental da organizaÃ§Ã£o e seus membros.'
Â  Â  Â  },
Â  Â  Â  'FERRAMENTAS': {
Â  Â  Â  Â  descricao: 'Avalia a disponibilidade e o uso de recursos e tecnologias.'
Â  Â  Â  },
Â  Â  Â  'DADOS': {
Â  Â  Â  Â  descricao: 'Foca na coleta, anÃ¡lise e utilizaÃ§Ã£o de informaÃ§Ãµes para decisÃµes.'
Â  Â  Â  },
Â  Â  Â  'RESULTADO': {
Â  Â  Â  Â  descricao: 'Mede o desempenho e a consecuÃ§Ã£o de metas e objetivos.'
Â  Â  Â  },
Â  Â  Â  'OBJETIVO': {
Â  Â  Â  Â  descricao: 'Determina a clareza e a ambiÃ§Ã£o dos propÃ³sitos da empresa.'
Â  Â  Â  },
Â  Â  Â  'PAPEL DO DONO': {
Â  Â  Â  Â  descricao: 'Avalia a atuaÃ§Ã£o e o envolvimento do proprietÃ¡rio ou principal gestor.'
Â  Â  Â  },
Â  Â  Â  'VERBO': {
Â  Â  Â  Â  descricao: 'Representa a aÃ§Ã£o e a dinÃ¢mica principal da empresa.'
Â  Â  Â  }
Â  Â  };

Â  Â  // UtilitÃ¡rios
Â  Â  const Utils = {
Â  Â  Â  // ValidaÃ§Ã£o de e-mail
Â  Â  Â  validarEmail(email) {
Â  Â  Â  Â  const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
Â  Â  Â  Â  return regex.test(email);
Â  Â  Â  },

Â  Â  Â  // ValidaÃ§Ã£o de nome
Â  Â  Â  validarNome(nome) {
Â  Â  Â  Â  return nome && nome.trim().length >= 2;
Â  Â  Â  },

Â  Â  Â  // FunÃ§Ã£o para debug
Â  Â  Â  debug(mensagem, dados = null) {
Â  Â  Â  Â  if (debugMode) {
Â  Â  Â  Â  Â  const debugInfo = document.getElementById("debug-info");
Â  Â  Â  Â  Â  debugInfo.style.display = "block";
Â  Â  Â  Â  Â  debugInfo.textContent += `\n[${new Date().toLocaleTimeString()}] ${mensagem}`;
Â  Â  Â  Â  Â  if (dados) {
Â  Â  Â  Â  Â  Â  debugInfo.textContent += `\nDados: ${JSON.stringify(dados, null, 2)}`;
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  console.log(`[DEBUG] ${mensagem}`, dados);
Â  Â  Â  },

Â  Â  Â  // FunÃ§Ã£o para delay
Â  Â  Â  delay(ms) {
Â  Â  Â  Â  return new Promise(resolve => setTimeout(resolve, ms));
Â  Â  Â  }
Â  Â  };

Â  Â  // ValidaÃ§Ã£o de formulÃ¡rio
Â  Â  const Validation = {
Â  Â  Â  showError(elementId, message) {
Â  Â  Â  Â  const errorElement = document.getElementById(elementId);
Â  Â  Â  Â  errorElement.textContent = message;
Â  Â  Â  Â  errorElement.classList.remove('hidden');
Â  Â  Â  },

Â  Â  Â  hideError(elementId) {
Â  Â  Â  Â  const errorElement = document.getElementById(elementId);
Â  Â  Â  Â  errorElement.classList.add('hidden');
Â  Â  Â  },

Â  Â  Â  validateForm() {
Â  Â  Â  Â  let isValid = true;
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Validar nome
Â  Â  Â  Â  const nome = document.getElementById("name").value.trim();
Â  Â  Â  Â  if (!Utils.validarNome(nome)) {
Â  Â  Â  Â  Â  this.showError('name-error', 'Por favor, insira seu nome completo (mÃ­nimo 2 caracteres).');
Â  Â  Â  Â  Â  isValid = false;
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  this.hideError('name-error');
Â  Â  Â  Â  }

Â  Â  Â  Â  // Validar e-mail
Â  Â  Â  Â  const email = document.getElementById("email").value.trim();
Â  Â  Â  Â  if (!Utils.validarEmail(email)) {
Â  Â  Â  Â  Â  this.showError('email-error', 'Por favor, insira um e-mail vÃ¡lido.');
Â  Â  Â  Â  Â  isValid = false;
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Validation.hideError('email-error');
Â  Â  Â  Â  }

Â  Â  Â  Â  return isValid;
Â  Â  Â  }
Â  Â  };

Â  Â  // Gerenciador de estado da aplicaÃ§Ã£o
Â  Â  const AppState = {
Â  Â  Â  reset() {
Â  Â  Â  Â  respostas = {};
Â  Â  Â  Â  pontuacoesCategorias = {}; // Resetar pontuaÃ§Ãµes
Â  Â  Â  Â  perguntaAtual = 0;
Â  Â  Â  Â  resultadoAtual = null;
Â  Â  Â  Â  emailEnviado = false;
Â  Â  Â  Â  tentativasEnvio = 0;
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (graficoChart) {
Â  Â  Â  Â  Â  graficoChart.destroy();
Â  Â  Â  Â  Â  graficoChart = null;
Â  Â  Â  Â  }
Â  Â  Â  },

Â  Â  Â  initializeCategories() {
Â  Â  Â  Â  // As categorias jÃ¡ estÃ£o na ordem desejada em categoriasBase
Â  Â  Â  Â  perguntas = categoriasBase; // 'perguntas' agora representa as categorias
Â  Â  Â  Â  // Inicializa as pontuaÃ§Ãµes para cada categoria
Â  Â  Â  Â  categoriasBase.forEach(cat => {
Â  Â  Â  Â  Â  Â  pontuacoesCategorias[cat.categoria] = 0;
Â  Â  Â  Â  });
Â  Â  Â  }
Â  Â  };

Â  Â  // Gerenciador de UI
Â  Â  const UI = {
Â  Â  Â  showSection(sectionId) {
Â  Â  Â  Â  document.querySelectorAll('.hidden').forEach(el => {
Â  Â  Â  Â  Â  if (el.id !== sectionId) el.classList.add('hidden');
Â  Â  Â  Â  });
Â  Â  Â  Â  document.getElementById(sectionId).classList.remove('hidden');
Â  Â  Â  },

Â  Â  Â  updateProgressBar() {
Â  Â  Â  Â  const progresso = (perguntaAtual / perguntas.length) * 100;
Â  Â  Â  Â  document.getElementById("progress").style.width = `${progresso}%`;
Â  Â  Â  },

Â  Â  Â  showLoadingMessage(message) {
Â  Â  Â  Â  document.getElementById("question-container").innerHTML = `<div class="loading">${message}</div>`;
Â  Â  Â  },

Â  Â  Â  showStatusMessage(elementId, message, type = null) {
Â  Â  Â  Â  const element = document.getElementById(elementId);
Â  Â  Â  Â  element.classList.remove("hidden", "success", "error", "warning");
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (type) {
Â  Â  Â  Â  Â  element.classList.add(type);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  element.textContent = message;
Â  Â  Â  }
Â  Â  };

Â  Â  // Gerenciador de resultados
Â  Â  const ResultsManager = {
Â  Â  Â  Â  calculateAndDisplayResults() {
Â  Â  Â  Â  Â  Â  document.getElementById("quiz").classList.add("hidden");
Â  Â  Â  Â  Â  Â  document.getElementById("resultado-container").classList.remove("hidden");

Â  Â  Â  Â  Â  Â  const maxScorePerCategory = 4;
Â  Â  Â  Â  Â  Â  const percentuaisCalculados = {};
Â  Â  Â  Â  Â  Â  for (const categoria in pontuacoesCategorias) {
Â  Â  Â  Â  Â  Â  Â  Â  const score = pontuacoesCategorias[categoria];
Â  Â  Â  Â  Â  Â  Â  Â  percentuaisCalculados[categoria] = (score / maxScorePerCategory) * 100;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Utils.debug("PontuaÃ§Ãµes por Categoria:", pontuacoesCategorias);
Â  Â  Â  Â  Â  Â  Utils.debug("Percentuais Calculados (apenas para webhook/n8n):", percentuaisCalculados);

Â  Â  Â  Â  Â  Â  resultadoAtual = {
Â  Â  Â  Â  Â  Â  Â  Â  userName: userName,
Â  Â  Â  Â  Â  Â  Â  Â  userEmail: userEmail,
Â  Â  Â  Â  Â  Â  Â  Â  pontuacoesCategorias: pontuacoesCategorias, // As pontuaÃ§Ãµes de 1-4
Â  Â  Â  Â  Â  Â  Â  Â  percentuaisCategorias: percentuaisCalculados // Os percentuais de 0-100% para o n8n
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  this.renderResults(resultadoAtual);
Â  Â  Â  Â  Â  Â  this.createChart(resultadoAtual.pontuacoesCategorias);Â 

Â  Â  Â  Â  Â  Â  // Configurar botÃ£o de reiniciar
Â  Â  Â  Â  Â  Â  document.getElementById("restart-button").addEventListener("click", () => {
Â  Â  Â  Â  Â  Â  Â  Â  location.reload();
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  // Pequeno atraso para garantir que o grÃ¡fico esteja completamente renderizado antes de capturar a imagem
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  EmailManager.sendResultEmail();
Â  Â  Â  Â  Â  Â  }, CONFIG.EMAIL_SEND_DELAY + 200); // 200ms extra para renderizaÃ§Ã£o do grÃ¡fico
Â  Â  Â  Â  },

Â  Â  Â  Â  showError(message) {
Â  Â  Â  Â  Â  Â  document.getElementById("perfil-titulo").textContent = "Erro ao processar resultados";
Â  Â  Â  Â  Â  Â  document.getElementById("perfil-detalhes").innerHTML = `<p>${message}</p>`;
Â  Â  Â  Â  },

Â  Â  Â  Â  renderResults(data) {
Â  Â  Â  Â  Â  Â  document.getElementById("perfil-titulo").innerHTML = `${data.userName}, aqui estÃ¡ a BÃºssola da Alta Performance da sua empresa!`;

Â  Â  Â  Â  Â  Â  let detalhesHTML = "<p>Esta bÃºssola reflete suas escolhas em diversas dimensÃµes empresariais:</p>";
Â  Â  Â  Â  Â  Â  detalhesHTML += "<ul>";
Â  Â  Â  Â  Â  Â  for (const categoria in data.pontuacoesCategorias) {
Â  Â  Â  Â  Â  Â  Â  Â  detalhesHTML += `<li class="perfil-item"><strong>${categoria}</strong>: ${data.pontuacoesCategorias[categoria]}</li>`;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  detalhesHTML += "</ul>";
Â  Â  Â  Â  Â  Â  detalhesHTML += "<p>Obrigado por participar da avaliaÃ§Ã£o!</p>";
Â  Â  Â  Â  Â  Â  document.getElementById("perfil-detalhes").innerHTML = detalhesHTML;
Â  Â  Â  Â  Â  Â  document.getElementById("perfil-detalhado").innerHTML = ""; // Limpar seÃ§Ã£o detalhada, pois nÃ£o hÃ¡ perfis especÃ­ficos
Â  Â  Â  Â  },

Â  Â  Â  Â  createChart(pontuacoes) { // Agora recebe as pontuaÃ§Ãµes diretas (1-4)
Â  Â  Â  Â  Â  Â  if (typeof Chart === 'undefined') {
Â  Â  Â  Â  Â  Â  Â  Â  Utils.debug("Chart.js nÃ£o disponÃ­vel");
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Utils.debug("Criando grÃ¡fico com pontuaÃ§Ãµes diretas", pontuacoes);

Â  Â  Â  Â  Â  Â  const labels = categoriasBase.map(cat => cat.categoria);
Â  Â  Â  Â  Â  Â  const values = labels.map(label => pontuacoes[label] || 0); // Usa as pontuaÃ§Ãµes diretas

Â  Â  Â  Â  Â  Â  const ctx = document.getElementById("graficoPerfil").getContext("2d");

Â  Â  Â  Â  Â  Â  // Cores genÃ©ricas para as 16 categorias (pode ser ajustado se houver preferÃªncia de cores)
Â  Â  Â  Â  Â  Â  const backgroundColors = [
Â  Â  Â  Â  Â  Â  Â  Â  'rgba(0, 123, 255, 0.3)', // Cor principal azul
Â  Â  Â  Â  Â  Â  Â  Â  'rgba(255, 99, 132, 0.2)', 'rgba(54, 162, 235, 0.2)', 'rgba(255, 206, 86, 0.2)', 'rgba(75, 192, 192, 0.2)',
Â  Â  Â  Â  Â  Â  Â  Â  'rgba(153, 102, 255, 0.2)', 'rgba(255, 159, 64, 0.2)', 'rgba(199, 199, 199, 0.2)', 'rgba(83, 102, 255, 0.2)',
Â  Â  Â  Â  Â  Â  Â  Â  'rgba(99, 255, 132, 0.2)', 'rgba(162, 54, 235, 0.2)', 'rgba(206, 255, 86, 0.2)', 'rgba(192, 75, 192, 0.2)',
Â  Â  Â  Â  Â  Â  Â  Â  'rgba(102, 153, 255, 0.2)', 'rgba(159, 255, 64, 0.2)', 'rgba(199, 83, 102, 0.2)', 'rgba(255, 99, 132, 0.2)'
Â  Â  Â  Â  Â  Â  ];
Â  Â  Â  Â  Â  Â  const borderColors = [
Â  Â  Â  Â  Â  Â  Â  Â  'rgb(0, 123, 255)', // Cor principal azul
Â  Â  Â  Â  Â  Â  Â  Â  'rgb(255, 99, 132)', 'rgb(54, 162, 235)', 'rgb(255, 206, 86)', 'rgb(75, 192, 192)',
Â  Â  Â  Â  Â  Â  Â  Â  'rgb(153, 102, 255)', 'rgb(255, 159, 64)', 'rgb(199, 199, 199)', 'rgb(83, 102, 255)',
Â  Â  Â  Â  Â  Â  Â  Â  'rgb(99, 255, 132)', 'rgb(162, 54, 235)', 'rgb(206, 255, 86)', 'rgb(192, 75, 192)',
Â  Â  Â  Â  Â  Â  Â  Â  'rgb(102, 153, 255)', 'rgb(159, 255, 64)', 'rgb(199, 83, 102)', 'rgb(255, 99, 132)'
Â  Â  Â  Â  Â  Â  ];


Â  Â  Â  Â  Â  Â  if (graficoChart) {
Â  Â  Â  Â  Â  Â  Â  Â  graficoChart.destroy(); // Destruir o grÃ¡fico anterior se existir
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  graficoChart = new Chart(ctx, {
Â  Â  Â  Â  Â  Â  Â  Â  type: "radar",
Â  Â  Â  Â  Â  Â  Â  Â  data: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  labels: labels,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  datasets: [{
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  label: 'Sua PontuaÃ§Ã£o', // RÃ³tulo sem '%'
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  data: values,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  backgroundColor: 'rgba(0, 123, 255, 0.3)', /* Cor de preenchimento azul */
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  borderColor: 'rgb(0, 123, 255)', /* Cor da linha azul */
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  pointBackgroundColor: backgroundColors, /* Cores para os pontos */
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  pointBorderColor: '#fff',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  pointHoverBackgroundColor: '#fff',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  pointHoverBorderColor: borderColors,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  borderWidth: 2,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  pointRadius: 6,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  pointHoverRadius: 8
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }]
Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  options: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  responsive: true,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  maintainAspectRatio: true,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scales: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  r: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  angleLines: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  color: 'rgba(255, 255, 255, 0.3)',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  lineWidth: 1
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  grid: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  color: 'rgba(255, 255, 255, 0.3)',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  lineWidth: 1
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  pointLabels: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  color: '#fff',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  font: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  size: 10, // Ajustado para caber 16 labels
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  weight: 'bold'
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ticks: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  color: '#fff',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  backdropColor: 'rgba(0, 0, 0, 0.7)',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  beginAtZero: true,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  min: 0,Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  max: 4,Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  stepSize: 1,Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showLabelBackdrop: true,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  font: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  size: 10
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // CORREÃ‡ÃƒO ANTERIOR: Garante que os rÃ³tulos 0, 1, 2, 3, 4 sejam exibidos
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  callback: function(value, index, values) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (Number.isInteger(value) && value >= 0 && value <= 4) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return value;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return null;Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  plugins: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  legend: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  position: "bottom",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  labels: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  color: '#fff',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  font: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  size: 12
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  title: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  display: true,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  text: "DistribuiÃ§Ã£o da BÃºssola da Alta Performance",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  color: "#ffffff",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  font: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  size: 16,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  weight: 'bold'
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tooltip: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  callbacks: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  label: function (context) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Mostra o rÃ³tulo e o valor da pontuaÃ§Ã£o (0-4)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return `${context.label}: ${context.parsed.r}`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Utils.debug("GrÃ¡fico de teia criado com sucesso.");
Â  Â  Â  Â  }
Â  Â  };

Â  Â  // Gerenciador de e-mail
Â  Â  const EmailManager = {
Â  Â  Â  Â  async sendResultEmail() {
Â  Â  Â  Â  Â  Â  if (emailEnviado || !this.isValidResult()) {
Â  Â  Â  Â  Â  Â  Â  Â  Utils.debug("E-mail nÃ£o enviado - jÃ¡ enviado ou resultado invÃ¡lido");
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  emailEnviado = true;
Â  Â  Â  Â  Â  Â  UI.showStatusMessage("email-status", "Enviando resultado para seu e-mail...", null);

Â  Â  Â  Â  Â  Â  // Pequeno atraso para garantir que o grÃ¡fico esteja completamente renderizado antes de capturar a imagem
Â  Â  Â  Â  Â  Â  await Utils.delay(500); // 500ms Ã© um bom ponto de partida, ajuste se necessÃ¡rio

Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const emailData = this.prepareEmailData();
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  const response = await fetch(CONFIG.WEBHOOK_URL, {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: "POST",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: { "Content-Type": "application/json" },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify(emailData)
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  if (response.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  UI.showStatusMessage("email-status",Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `Resultado enviado com sucesso para ${resultadoAtual.userEmail}!`, "success");
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error(`HTTP ${response.status}`);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  Utils.debug("Erro ao enviar e-mail", error);
Â  Â  Â  Â  Â  Â  Â  Â  UI.showStatusMessage("email-status",Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  "Erro ao enviar e-mail. Por favor, tente novamente mais tarde.", "error");
Â  Â  Â  Â  Â  Â  Â  Â  emailEnviado = false;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  },

Â  Â  Â  Â  isValidResult() {
Â  Â  Â  Â  Â  Â  // Verifica se hÃ¡ pontuaÃ§Ãµes calculadas e se o e-mail estÃ¡ presente
Â  Â  Â  Â  Â  Â  return resultadoAtual &&
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Object.keys(resultadoAtual.pontuacoesCategorias).length > 0 && // Mudado para pontuacoesCategorias
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  resultadoAtual.userEmail;
Â  Â  Â  Â  },

Â  Â  Â  Â  prepareEmailData() {
Â  Â  Â  Â  Â  Â  let graficoImgBase64 = null;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  if (graficoChart) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const canvas = document.getElementById("graficoPerfil");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  graficoImgBase64 = canvas.toDataURL("image/png");
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  Utils.debug("Erro ao capturar grÃ¡fico para e-mail", error);
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  return {
Â  Â  Â  Â  Â  Â  Â  Â  userName: resultadoAtual.userName,
Â  Â  Â  Â  Â  Â  Â  Â  userEmail: resultadoAtual.userEmail,
Â  Â  Â  Â  Â  Â  Â  Â  // Mantemos percentuaisCategorias aqui, pois o n8n JSON Code pode ainda esperar isso para a anÃ¡lise detalhada.
Â  Â  Â  Â  Â  Â  Â  Â  pontuacoesCategorias: resultadoAtual.pontuacoesCategorias,Â 
Â  Â  Â  Â  Â  Â  Â  Â  percentuaisCategorias: resultadoAtual.percentuaisCategorias,
Â  Â  Â  Â  Â  Â  Â  Â  graficoBase64: graficoImgBase64,
Â  Â  Â  Â  Â  Â  Â  Â  acao: "enviar_email_bussola" // AÃ§Ã£o especÃ­fica para o webhook
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  }
Â  Â  };

Â  Â  // Gerenciador de quiz
Â  Â  const QuizManager = {
Â  Â  Â  start() {
Â  Â  Â  Â  if (!Validation.validateForm()) {
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  userName = document.getElementById("name").value.trim();
Â  Â  Â  Â  userEmail = document.getElementById("email").value.trim();

Â  Â  Â  Â  AppState.reset();
Â  Â  Â  Â  AppState.initializeCategories(); // Inicializa as categorias e pontuaÃ§Ãµes

Â  Â  Â  Â  document.getElementById("intro-container").classList.add("hidden");
Â  Â  Â  Â  document.getElementById("quiz").classList.remove("hidden");

Â  Â  Â  Â  UI.updateProgressBar();
Â  Â  Â  Â  this.showQuestion(perguntaAtual);
Â  Â  Â  },

Â  Â  Â  showQuestion(index) {
Â  Â  Â  Â  if (index >= perguntas.length) {
Â  Â  Â  Â  Â  ResultsManager.calculateAndDisplayResults(); // Agora calcula e exibe localmente
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  const categoria = perguntas[index];
Â  Â  Â  Â  // O texto da "pergunta" Ã© o nome da categoria
Â  Â  Â  Â  let html = `<p><strong>${index + 1}/${perguntas.length}. Selecione a opÃ§Ã£o que melhor descreve a dimensÃ£o "${categoria.categoria}":</strong></p>`;
Â  Â  Â  Â Â 
Â  Â  Â  Â  categoria.opcoes.forEach((opcao, idx) => {
Â  Â  Â  Â  Â  // NOVO: Adiciona um ID Ãºnico para o input de rÃ¡dio e o associa ao label
Â  Â  Â  Â  Â  const radioId = `q${index}-opt${idx}`; 
Â  Â  Â  Â  Â  html += `<label for="${radioId}"><input type="radio" id="${radioId}" name="resposta" value="${opcao.valor}" data-categoria="${categoria.categoria}" /> ${String.fromCharCode(97 + idx)}) ${opcao.texto}</label>`;
Â  Â  Â  Â  });
Â  Â  Â  Â Â 
Â  Â  Â  Â  html += `<div class="container" style="margin-top: 15px;"><button id="next-button">PrÃ³xima</button></div>`;
Â  Â  Â  Â Â 
Â  Â  Â  Â  document.getElementById("question-container").innerHTML = html;
Â  Â  Â  Â Â 
Â  Â  Â  Â  document.getElementById("next-button").addEventListener("click", () => {
Â  Â  Â  Â  Â  this.registerAnswer(index);
Â  Â  Â  Â  });
Â  Â  Â  },

Â  Â  Â  registerAnswer(index) {
Â  Â  Â  Â  const selected = document.querySelector("input[name='resposta']:checked");
Â  Â  Â  Â  if (!selected) {
Â  Â  Â  Â  Â  alert("Por favor, selecione uma resposta.");
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
        // NOVO: Adiciona debug para o valor capturado do input de rÃ¡dio
        Utils.debug("Valor do rÃ¡dio selecionado (raw):", selected.value);

Â  Â  Â  Â  const categoriaSelecionada = perguntas[index].categoria;
Â  Â  Â  Â  const valorSelecionado = parseInt(selected.value);

Â  Â  Â  Â  pontuacoesCategorias[categoriaSelecionada] = valorSelecionado;
Â  Â  Â  Â  Utils.debug(`Resposta para ${categoriaSelecionada}: ${valorSelecionado} pontos`);

Â  Â  Â  Â  perguntaAtual++;
Â  Â  Â  Â  UI.updateProgressBar();
Â  Â  Â  Â  this.showQuestion(perguntaAtual);
Â  Â  Â  }
Â  Â  };

Â  Â  // InicializaÃ§Ã£o da aplicaÃ§Ã£o
Â  Â  document.addEventListener("DOMContentLoaded", function() {
Â  Â  Â  // Configurar eventos
Â  Â  Â  document.getElementById("start-button").addEventListener("click", () => {
Â  Â  Â  Â  QuizManager.start();
Â  Â  Â  });
Â  Â  Â Â 
Â  Â  Â  // Verificar modo debug
Â  Â  Â  if (window.location.search.includes('debug=true')) {
Â  Â  Â  Â  debugMode = true;
Â  Â  Â  Â  document.getElementById("debug-info").style.display = "block";
Â  Â  Â  Â  Utils.debug("Modo de debug ativado");
Â  Â  Â  }

Â  Â  Â  // ValidaÃ§Ã£o em tempo real
Â  Â  Â  document.getElementById("name").addEventListener("blur", () => {
Â  Â  Â  Â  const nome = document.getElementById("name").value.trim();
Â  Â  Â  Â  if (nome && !Utils.validarNome(nome)) {
Â  Â  Â  Â  Â  Validation.showError('name-error', 'Nome deve ter pelo menos 2 caracteres.');
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Validation.hideError('name-error');
Â  Â  Â  Â  }
Â  Â  Â  });

Â  Â  Â  document.getElementById("email").addEventListener("blur", () => {
Â  Â  Â  Â  const email = document.getElementById("email").value.trim();
Â  Â  Â  Â  if (email && !Utils.validarEmail(email)) {
Â  Â  Â  Â  Â  Validation.showError('email-error', 'Por favor, insira um e-mail vÃ¡lido.');
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Validation.hideError('email-error');
Â  Â  Â  Â  }
Â  Â  Â  });
Â  Â  });
Â  </script>
Â Â 
Â  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</body>
</html>
